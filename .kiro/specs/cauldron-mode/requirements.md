# Requirements Document

## Introduction

The Cauldron Mode is a convergent idea synthesis feature that allows users to mix multiple ideas from various sources (saved ideas, AI suggestions, user inputs) into a single, highly personalized output. Unlike Spark Mode which generates multiple divergent ideas, Cauldron Mode uses pattern analysis to synthesize ingredients into one strong, focused idea based on observed user preferences and behaviors.

## Glossary

- **Cauldron Mode**: A convergent synthesis feature where users mix ideas to generate one personalized output
- **Floating Ideas**: Ideas that drift around the screen, sourced from saved ideas and other sources
- **Cauldron**: The central visual element where users drop ideas to mix them
- **Ingredient**: An idea that has been added to the cauldron for mixing
- **Mixing**: The AI process of analyzing ingredients and synthesizing them into one output
- **Cauldron Output**: The single synthesized idea generated by the AI after mixing
- **Pattern Analysis**: AI detection of themes and preferences based on what users add to the cauldron
- **Session**: A single cauldron mixing attempt with its ingredients and output

## Requirements

### Requirement 1

**User Story:** As a user with vague or scattered ideas, I want to see floating ideas from my saved collection and other sources, so that I can explore potential ingredients for mixing

#### Acceptance Criteria

1. WHEN the user navigates to Cauldron Mode, THE System SHALL display 8-10 floating ideas that drift around the screen
2. THE System SHALL source 60% of floating ideas from the user's saved ideas collection
3. THE System SHALL source 40% of floating ideas from recent spark runs including AI-generated ideas, lens ideas, and user prompts
4. WHEN the user has no saved ideas, THE System SHALL source 100% of floating ideas from spark runs
5. WHILE ideas are floating, THE System SHALL apply gentle drift and rotation animations
6. WHEN a floating idea is added to the cauldron, THE System SHALL rotate in a new floating idea to maintain the 8-10 count
7. THE System SHALL automatically rotate one floating idea every 15-20 seconds by fading it out and fading in a new idea
8. THE automatic rotation SHALL select ideas that have not been recently displayed to maximize variety

### Requirement 2

**User Story:** As a user, I want to drag floating ideas into a central cauldron, so that I can select which ideas to mix together

#### Acceptance Criteria

1. THE System SHALL display a central cauldron visual element that accepts dragged ideas
2. WHEN the user drags a floating idea, THE System SHALL provide visual feedback indicating the drag state
3. WHEN the user drops an idea onto the cauldron, THE System SHALL add the idea as an ingredient with a dissolving animation
4. THE System SHALL track the order in which ingredients are added to the cauldron
5. THE System SHALL persist the current cauldron state if the user navigates away from the page

### Requirement 3

**User Story:** As a user, I want to add my own ideas directly into the cauldron, so that I can include fresh thoughts in the mixing process

#### Acceptance Criteria

1. THE System SHALL provide a fixed-position input field for adding new ideas
2. THE input field SHALL be positioned naturally without distracting from the mixing process
3. WHEN the user submits a new idea through the input field, THE System SHALL add it to the cauldron as an ingredient
4. THE System SHALL clear the input field after successfully adding an idea
5. THE System SHALL track user-input ingredients separately from saved or AI-generated sources

### Requirement 4

**User Story:** As a user, I want the cauldron to start mixing automatically when I have enough ingredients, so that I can see the synthesis happen without manual triggering

#### Acceptance Criteria

1. THE System SHALL require a minimum of 3 ingredients before mixing can begin
2. WHEN fewer than 3 ingredients are in the cauldron, THE System SHALL display a counter showing how many more ideas are needed
3. WHEN the ingredient count reaches 3, THE System SHALL automatically start the mixing animation
4. WHILE mixing is in progress, THE System SHALL display visual feedback including swirling particles, color shifts, and glow effects
5. WHEN additional ingredients are added during mixing, THE System SHALL automatically trigger a remix with all current ingredients

### Requirement 5

**User Story:** As a user, I want the AI to analyze patterns in my ingredient choices, so that the output is personalized to my interests

#### Acceptance Criteria

1. THE System SHALL track all ingredients added to the cauldron in each session
2. THE System SHALL analyze the user's saved ideas history to identify preference patterns
3. THE System SHALL analyze previous cauldron outputs to learn what resonated with the user
4. THE System SHALL use the convergent agent pattern to synthesize ingredients into one compelling idea
5. THE System SHALL NOT display detected patterns to the user

### Requirement 6

**User Story:** As a user, I want to see a special animation when the mixing completes, so that the output feels like a meaningful result

#### Acceptance Criteria

1. WHEN the AI completes synthesis, THE System SHALL display a completion animation showing the output emerging from the cauldron
2. THE output animation SHALL use witch's cauldron aesthetic elements including steam, glow, or mystical effects
3. THE System SHALL display the synthesized output as a visually distinct card
4. THE output card SHALL be positioned prominently for easy reading
5. THE animation duration SHALL be under 2 seconds to maintain momentum

### Requirement 7

**User Story:** As a user, I want to save exceptional cauldron outputs, so that I can preserve ideas that truly resonate with me

#### Acceptance Criteria

1. THE System SHALL provide a save action for cauldron outputs
2. WHEN the user saves a cauldron output, THE System SHALL add it to their saved ideas collection
3. THE System SHALL mark saved cauldron outputs with a special visual indicator
4. WHEN a cauldron output is saved, THE System SHALL position it as the first pin in the saved collection
5. THE System SHALL apply special styling to saved cauldron outputs to distinguish them from regular saved ideas

### Requirement 8

**User Story:** As a user, I want to start fresh if I add a bad ingredient, so that I can reset the cauldron without being stuck with unwanted ideas

#### Acceptance Criteria

1. THE System SHALL provide a reset action that clears all ingredients from the cauldron
2. WHEN the user triggers reset, THE System SHALL remove all current ingredients and stop any mixing in progress
3. THE System SHALL NOT allow removal of individual ingredients once added
4. WHEN the cauldron is reset, THE System SHALL return to the initial state showing the empty cauldron
5. THE System SHALL preserve the floating ideas when the cauldron is reset

### Requirement 9

**User Story:** As a user, I want to access Cauldron Mode from the main navigation, so that I can easily switch between different modes

#### Acceptance Criteria

1. THE System SHALL add a Cauldron Mode link to the main navigation bar
2. THE navigation link SHALL use an icon that clearly represents the cauldron concept
3. WHEN the user clicks the navigation link, THE System SHALL navigate to the Cauldron Mode page
4. THE System SHALL maintain the user's current cauldron session when navigating to the page
5. THE Cauldron Mode page SHALL be accessible at a dedicated route

### Requirement 10

**User Story:** As a user, I want my cauldron session to persist if I accidentally leave the page, so that I don't lose my progress

#### Acceptance Criteria

1. THE System SHALL save the current cauldron session state to the database
2. THE saved state SHALL include all current ingredients and their order
3. WHEN the user returns to Cauldron Mode, THE System SHALL restore the previous session if it exists
4. THE System SHALL restore any mixing in progress when the session is loaded
5. THE System SHALL create a new session only when the user explicitly resets the cauldron or saves an output
